<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MediQueue</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">

  <!-- Bootstrap CSS for Prescription Modal -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* code1 and code2 combined styles */

    /* Global styles - from code1 */
    * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
    body {
      margin: 0;
      padding: 0;
      /* Hospital background image (change the URL if needed) */
      background-image: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1500&q=80');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      font-family: 'Roboto', sans-serif; /* from code2 - override for consistency */
    }
    .container {
      width: 100%;
      max-width: 800px;
      background: white;
      margin: 40px auto;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    h2, h4, h1 {
      text-align: center;
      color: #0d47a1;
    }
    input, select, button, textarea {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #28a745;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover { background-color: #218838; }
    .blue-btn {
      background-color: #1976d2;
      color: #fff;
      margin-top: 10px;
      padding: 12px;
      border-radius: 8px;
      border: none;
      width: 100%;
      font-weight: bold;
      cursor: pointer;
    }
    .blue-btn:hover { background-color: #1565c0; }
    .link { text-align: center; margin-top: 10px; }
    .link a { text-decoration: none; color: #007bff; }
    .social { display: flex; justify-content: center; gap: 20px; margin-top: 10px; }
    .social img { width: 40px; cursor: pointer; }
    .hidden { display: none; }
    .edit-profile { text-align: right; margin-top: -25px; margin-bottom: 10px; }
    .edit-profile button {
      background: none; border: none; font-size: 20px; color: #1976d2; cursor: pointer;
    }
    .card {
      background-color: #f5f5f5;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 10px;
      color: #333;
    }
    .welcome-message { text-align: center; font-size: 18px; margin-top: -10px; margin-bottom: 20px; color: #333; }
    #editModal {
      display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.4); justify-content: center; align-items: center; z-index: 999;
    }
    #editModal .modal-content {
      background: white; padding: 20px; border-radius: 10px; width: 90%; max-width: 400px;
    }
    #aboutSection {
      background-color: #e3f2fd;
      padding: 15px; border-radius: 10px; margin-top: 20px; color: #333;
    }
    /* Appointment Section */
    #appointmentPage h1 { text-align: center; color: #006064; }
    .doctors-container {
      display: flex; flex-wrap: wrap; gap: 20px;
      justify-content: center; margin-top: 30px;
    }
    .doctor-card {
      background: #fff; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      padding: 20px; width: 320px; text-align: center;
    }
    .doctor-card img { width: 100px; border-radius: 50%; }
    .doctor-name { font-size: 20px; font-weight: bold; margin: 10px 0 5px; }
    .doctor-specialty { color: #00796b; margin-bottom: 8px; }
    .doctor-details { font-size: 14px; color: #555; margin-bottom: 6px; }
    .doctor-bio { font-size: 14px; color: #777; margin-bottom: 12px; }
    .book-btn {
      background: #0097a7; color: white; border: none; padding: 10px 20px;
      border-radius: 8px; cursor: pointer;
    }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); justify-content: center; align-items: center; }
    .modal-content { background: white; padding: 30px; border-radius: 10px; width: 320px; text-align: center; }
    .modal-content input, .modal-content button { width: 100%; padding: 10px; margin-top: 15px; border-radius: 6px; border: 1px solid #ccc; }
    .confirm-msg { margin-top: 20px; color: green; font-weight: bold; text-align: center; }

    /* View Queue Section */
    #queuePage {
      background: #f0f6ff;
      padding: 20px;
      text-align: center;
    }
    #queueBox, #currentBox {
      background: #ffffff;
      border-radius: 15px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 20px;
      margin: 20px auto;
      max-width: 500px;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: #eaf4ff;
      margin: 8px 0;
      padding: 10px;
      border-radius: 10px;
    }
    .btn {
      background: #3498db;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 10px;
      margin: 5px;
      cursor: pointer;
    }
    .btn:hover {
      background: #2980b9;
    }
    #notification {
      background: #d1f5d3;
      padding: 15px;
      border-radius: 10px;
      margin-top: 10px;
      display: none;
      color: #2e7d32;
    }

    /* Medical Reports Styles from code2 */
    /* Override container max-width for Medical Reports */
    #medicalReportsPage .container {
      max-width: 1100px;
      margin: 40px auto;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    #medicalReportsPage header {
      background-color: #1976d2;
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      border-radius: 10px 10px 0 0;
    }

    #medicalReportsPage .report-card {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #ddd;
      padding: 20px 0;
    }

    #medicalReportsPage .report-info {
      flex: 3;
    }

    #medicalReportsPage .report-info h3 {
      margin: 0;
      font-size: 20px;
      color: #333;
    }

    #medicalReportsPage .report-info p {
      margin: 5px 0;
      color: #666;
      font-size: 14px;
    }

    #medicalReportsPage .doctor-info {
      flex: 2;
      padding-left: 20px;
    }

    #medicalReportsPage .doctor-info strong {
      color: #1976d2;
    }

    #medicalReportsPage .book-section {
      flex: 3;
      text-align: right;
    }

    #medicalReportsPage .book-section input, #medicalReportsPage .book-section button {
      margin: 5px;
      padding: 6px;
      font-size: 14px;
    }

    #medicalReportsPage .book-section button {
      background-color: #1976d2;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: 0.3s;
    }

    #medicalReportsPage .book-section button:hover {
      background-color: #125fa3;
    }

    @media (max-width: 768px) {
      #medicalReportsPage .report-card {
        flex-direction: column;
        align-items: flex-start;
      }
      #medicalReportsPage .book-section {
        text-align: left;
        margin-top: 10px;
      }
    }

    /* code2 styles for Prescription Page */

    /* Override container max-width for Prescription Page */
    #prescriptionPage .container {
      max-width: 700px;
      background-color: #ffffff;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      padding: 30px;
      margin: 40px auto;
    }

    #prescriptionPage h2 {
      color: #0d47a1;
      text-align: center;
      margin-bottom: 1.5rem;
    }

    #prescriptionPage button {
      border-radius: 10px;
    }

    #prescriptionDetails {
      background-color: #f8f9fa;
      border: 1px solid #dcdcdc;
      border-radius: 10px;
      padding: 15px;
      color: #6c757d;
      font-size: 1rem;
    }

    .modal-content {
      border-radius: 15px;
    }

    .modal-header {
      background-color: #0d6efd;
      color: #fff;
      border-top-left-radius: 15px;
      border-top-right-radius: 15px;
    }

    .modal-footer {
      background-color: #f1f1f1;
      border-bottom-left-radius: 15px;
      border-bottom-right-radius: 15px;
    }

    .back-btn {
      background-color: #ffc107;
      color: #212529;
      border: none;
    }

    .back-btn:hover {
      background-color: #e0a800;
    }
  </style>
</head>
<body>

  <!-- REGISTER PAGE -->
  <div id="registerPage" class="container">
    <h2>Sign Up</h2>
    <input type="text" id="regName" placeholder="Full Name" />
    <input type="email" id="regEmail" placeholder="Email" />
    <input type="password" id="regPassword" placeholder="Password" />
    <input type="password" id="regConfirmPassword" placeholder="Confirm Password" />
    <select id="regRole">
      <option value="" disabled selected>Select Role</option>
      <option value="Doctor">Doctor</option>
      <option value="Patient">Patient</option>
    </select>
    <button onclick="register()">Sign Up</button>
    <div class="link">Already have an account? <a href="#" onclick="showLogin()">Log In</a></div>
    <div class="social">
      <img src="https://cdn-icons-png.flaticon.com/512/300/300221.png" alt="Google" title="Login with Google" />
      <img src="https://cdn-icons-png.flaticon.com/512/124/124010.png" alt="Facebook" title="Login with Facebook" />
    </div>
  </div>

  <!-- LOGIN PAGE -->
  <div id="loginPage" class="container hidden">
    <h2>Log In</h2>
    <input type="email" id="loginEmail" placeholder="Email" />
    <input type="password" id="loginPassword" placeholder="Password" />
    <div class="link"><a href="#">Forgot Password?</a></div>
    <button onclick="login()">Log In</button>
    <div class="link">Don't have an account? <a href="#" onclick="showRegister()">Sign Up</a></div>
    <div class="social">
      <img src="https://cdn-icons-png.flaticon.com/512/300/300221.png" alt="Google" title="Login with Google" />
      <img src="https://cdn-icons-png.flaticon.com/512/124/124010.png" alt="Facebook" title="Login with Facebook" />
    </div>
  </div>

  <!-- DASHBOARD PAGE -->
  <div id="dashboardPage" class="container hidden">
    <button onclick="showRegister()" style="background:#ffc107;color:#000;margin-bottom: 15px;">⬅ Logout</button>
    <h2>MediQueue</h2>
    <div class="welcome-message">Welcome to MediQueue, <span id="userName"></span> 👋</div>
    <div class="card">
      <div class="edit-profile">
        <button onclick="openEditModal()" title="Edit Profile">✏</button>
      </div>
      <h4>Your Profile</h4>
      <p><strong>Name:</strong> <span id="profileName"></span></p>
      <p><strong>Role:</strong> <span id="profileRole"></span></p>
      <p><strong>Email:</strong> <span id="profileEmail"></span></p>
    </div>
    <button class="blue-btn" onclick="showAppointment()">📅 Book Appointment</button>
    <button class="blue-btn" onclick="showQueue()">📋 View Queue</button>
    <!-- Updated Medical Reports button to show medicalReportsPage -->
    <button id="medicalReportsBtn" class="blue-btn">📁 Medical Reports</button>
    <button id="prescriptionBtn" class="blue-btn">📄 Prescriptions</button>

    <h4 style="margin-top: 20px;">Notifications</h4>
    <div class="card">🔔 Reminder: Your general checkup is due next week.</div>
    <div class="card">💊 Medication Alert: Take your tablets at 8 AM.</div>
    <div id="aboutSection">
      <h4>About MediQueue</h4>
      <p>MediQueue is a smart hospital management system designed to streamline the appointment booking process,  
        manage patient queues, and provide digital access to medical records and prescriptions.</p>
    </div>
  </div>

  <!-- APPOINTMENT PAGE -->
  <div id="appointmentPage" class="container hidden">
    <button onclick="backToDashboard()" style="background:#ffc107;color:#000;margin-bottom: 15px;">⬅ Back</button>
    <h1>Book an Appointment</h1>
    <div class="doctors-container" id="doctorsList"></div>

    <!-- Modal -->
    <div class="modal" id="appointmentModal">
      <div class="modal-content">
        <h3>Select Date and Time</h3>
        <input type="date" id="appointmentDate" />
        <input type="time" id="appointmentTime" />
        <button onclick="confirmBooking()">Confirm Booking</button>
      </div>
    </div>
    <div class="confirm-msg" id="confirmationMsg"></div>
  </div>

  <!-- VIEW QUEUE PAGE -->
  <div id="queuePage" class="container hidden">
    <button onclick="backToDashboardFromQueue()" style="background:#ffc107;color:#000;margin-bottom: 15px;">⬅ Back</button>
    <h1>🔁 View Queue</h1>
    <div id="currentBox">
      <h2>Now Serving: <span id="currentToken">1</span></h2>
      <button class="btn" onclick="nextPatient()">Next Patient</button>
      <button class="btn" onclick="completeCheckup()">Complete Checkup</button>
    </div>
    <div id="queueBox">
      <h3>Waiting List</h3>
      <ul id="queueList"></ul>
    </div>
    <div id="notification"></div>
  </div>

  <!-- MEDICAL REPORTS PAGE (from code2) -->
  <div id="medicalReportsPage" class="container hidden">
    <button id="backFromReports" style="background:#ffc107;color:#000;margin-bottom: 15px;">⬅ Back</button>
    <header>Medical Reports - MediQueue</header>
    <div class="container">

      <!-- Report 1 -->
      <div class="report-card">
        <div class="report-info">
          <h3>Blood Test</h3>
          <p>Includes CBC, Glucose, Lipid profile, LFT, KFT, etc.</p>
        </div>
        <div class="doctor-info">
          <p><strong>Doctor:</strong> Dr. R. Mehta</p>
          <p><strong>Specialization:</strong> Pathologist</p>
        </div>
        <div class="book-section">
          <label>Date: <input type="date"></label><br>
          <label>Time: <input type="time"></label><br>
          <button>Book Test</button>
        </div>
      </div>

      <!-- Report 2 -->
      <div class="report-card">
        <div class="report-info">
          <h3>X-Ray</h3>
          <p>Chest X-ray, bone fractures, lung and joint imaging.</p>
        </div>
        <div class="doctor-info">
          <p><strong>Doctor:</strong> Dr. A. Verma</p>
          <p><strong>Specialization:</strong> Radiologist</p>
        </div>
        <div class="book-section">
          <label>Date: <input type="date"></label><br>
          <label>Time: <input type="time"></label><br>
          <button>Book Test</button>
        </div>
      </div>

      <!-- Report 3 -->
      <div class="report-card">
        <div class="report-info">
          <h3>MRI Scan</h3>
          <p>Brain, spine, joint scans using magnetic imaging.</p>
        </div>
        <div class="doctor-info">
          <p><strong>Doctor:</strong> Dr. S. Rao</p>
          <p><strong>Specialization:</strong> Neuro-Radiologist</p>
        </div>
        <div class="book-section">
          <label>Date: <input type="date"></label><br>
          <label>Time: <input type="time"></label><br>
          <button>Book Test</button>
        </div>
      </div>

      <!-- Report 4 -->
      <div class="report-card">
        <div class="report-info">
          <h3>ECG</h3>
          <p>Electrocardiogram for heart rhythm monitoring and analysis.</p>
        </div>
        <div class="doctor-info">
          <p><strong>Doctor:</strong> Dr. P. Sharma</p>
          <p><strong>Specialization:</strong> Cardiologist</p>
        </div>
        <div class="book-section">
          <label>Date: <input type="date"></label><br>
          <label>Time: <input type="time"></label><br>
          <button>Book Test</button>
        </div>
      </div>

      <!-- Report 5 -->
      <div class="report-card">
        <div class="report-info">
          <h3>Ultrasound</h3>
          <p>Pregnancy, abdominal, kidney, and pelvic scan using sound waves.</p>
        </div>
        <div class="doctor-info">
          <p><strong>Doctor:</strong> Dr. M. Iqbal</p>
          <p><strong>Specialization:</strong> Sonologist</p>
        </div>
        <div class="book-section">
          <label>Date: <input type="date"></label><br>
          <label>Time: <input type="time"></label><br>
          <button>Book Test</button>
        </div>
      </div>

      <!-- Report 6 -->
      <div class="report-card">
        <div class="report-info">
          <h3>CT Scan</h3>
          <p>Detailed cross-sectional images for internal organ examination.</p>
        </div>
        <div class="doctor-info">
          <p><strong>Doctor:</strong> Dr. A. Dey</p>
          <p><strong>Specialization:</strong> CT Specialist</p>
        </div>
        <div class="book-section">
          <label>Date: <input type="date"></label><br>
          <label>Time: <input type="time"></label><br>
          <button>Book Test</button>
        </div>
      </div>

      <!-- Report 7 -->
      <div class="report-card">
        <div class="report-info">
          <h3>Thyroid Profile</h3>
          <p>TSH, T3, T4 levels to diagnose thyroid gland functioning.</p>
        </div>
        <div class="doctor-info">
          <p><strong>Doctor:</strong> Dr. L. Narayan</p>
          <p><strong>Specialization:</strong> Endocrinologist</p>
        </div>
        <div class="book-section">
          <label>Date: <input type="date"></label><br>
          <label>Time: <input type="time"></label><br>
          <button>Book Test</button>
        </div>
      </div>

      <!-- Report 8 -->
      <div class="report-card">
        <div class="report-info">
          <h3>COVID-19 RT-PCR</h3>
          <p>Swab test for COVID-19 detection via real-time PCR technology.</p>
        </div>
        <div class="doctor-info">
          <p><strong>Doctor:</strong> Dr. V. Srinivas</p>
          <p><strong>Specialization:</strong> Virologist</p>
        </div>
        <div class="book-section">
          <label>Date: <input type="date"></label><br>
          <label>Time: <input type="time"></label><br>
          <button>Book Test</button>
        </div>
      </div>

    </div>
  </div>

  <!-- PRESCRIPTION PAGE -->
  <div id="prescriptionPage" class="container hidden">
    <button class="btn back-btn mb-3" id="backFromPrescription">
      ← Back
    </button>

    <h2 class="mb-4 text-primary">Prescription</h2>

    <!-- Button to Upload Prescription -->
    <button class="btn btn-success mb-3" data-bs-toggle="modal" data-bs-target="#uploadPrescriptionModal">
      Upload Prescription
    </button>

    <!-- Prescription Details Section -->
    <div id="prescriptionDetails" class="card p-3">
      <h5 class="card-title text-dark">Prescription Details</h5>
      <p id="prescriptionContent" class="card-text text-muted">No prescription uploaded yet.</p>
    </div>
  </div>

  <!-- EDIT MODAL -->
  <div id="editModal">
    <div class="modal-content">
      <h3>Edit Profile</h3>
      <input type="text" id="editName" placeholder="Full Name" />
      <input type="email" id="editEmail" placeholder="Email" />
      <select id="editRole">
        <option value="Doctor">Doctor</option>
        <option value="Patient">Patient</option>
      </select>
      <button onclick="saveProfile()">Save</button>
      <button onclick="closeEditModal()" style="margin-top: 10px; background: #dc3545;">Cancel</button>
    </div>
  </div>

<!-- Bootstrap JS + Popper (needed for modal) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // --- QUEUE DATA ---
  let queue = [
    { name: "Patient A", token: 1 },
    { name: "Patient B", token: 2 },
    { name: "Patient C", token: 3 },
    { name: "You", token: 4 },
    { name: "Patient E", token: 5 },
    { name: "Patient F", token: 6 },
  ];
  let currentToken = 1;

  // --- DOCTOR DATA ---
  const doctors = [
    { name: "Dr. Aisha Mehra", specialty: "Cardiologist", education: "MD, AIIMS Delhi", experience: 12, languages: ["English", "Hindi"], bio: "Expert in heart care, managing complex cardiovascular conditions.", image: "https://via.placeholder.com/100?text=Aisha" },
    { name: "Dr. Ravi Kumar", specialty: "Neurologist", education: "DM Neurology, NIMHANS", experience: 8, languages: ["English", "Kannada", "Hindi"], bio: "Specialist in epilepsy and stroke management.", image: "https://via.placeholder.com/100?text=Ravi" },
    { name: "Dr. Sunita Patel", specialty: "Dermatologist", education: "MD Dermatology, CMC Vellore", experience: 7, languages: ["English", "Hindi", "Gujarati"], bio: "Focus on skin rejuvenation and acne treatments.", image: "https://via.placeholder.com/100?text=Sunita" },
    { name: "Dr. Arjun Reddy", specialty: "Orthopedic Surgeon", education: "MS Orthopedics, KEM Mumbai", experience: 10, languages: ["English", "Telugu", "Hindi"], bio: "Experience in joint replacement and sports injuries.", image: "https://via.placeholder.com/100?text=Arjun" },
    { name: "Dr. Priya Singh", specialty: "Pediatrician", education: "MD Pediatrics, AIIMS Delhi", experience: 9, languages: ["English", "Hindi"], bio: "Child health expert, vaccination specialist.", image: "https://via.placeholder.com/100?text=Priya" },
    { name: "Dr. Karan Sharma", specialty: "Gastroenterologist", education: "DM Gastroenterology, SGPGI", experience: 11, languages: ["English", "Hindi"], bio: "Treats digestive system disorders and liver diseases.", image: "https://via.placeholder.com/100?text=Karan" },
    { name: "Dr. Neha Verma", specialty: "Psychiatrist", education: "MD Psychiatry, NIMHANS", experience: 6, languages: ["English", "Hindi"], bio: "Specializes in anxiety, depression, and adolescent counseling.", image: "https://via.placeholder.com/100?text=Neha" },
    { name: "Dr. Akash Rao", specialty: "Ophthalmologist", education: "MS Ophthalmology, LVPEI", experience: 8, languages: ["English", "Telugu", "Hindi"], bio: "Expert in cataract surgery and vision correction.", image: "https://via.placeholder.com/100?text=Akash" }
  ];

  const doctorsList = document.getElementById("doctorsList");
  const modal = document.getElementById("appointmentModal");
  const confirmationMsg = document.getElementById("confirmationMsg");
  let selectedDoctor = null;

  // --- PAGE TOGGLE FUNCTIONS ---
  function showLogin() {
    document.getElementById('registerPage').classList.add('hidden');
    document.getElementById('loginPage').classList.remove('hidden');
    // Hide all others
    document.getElementById('dashboardPage').classList.add('hidden');
    document.getElementById('appointmentPage').classList.add('hidden');
    document.getElementById('queuePage').classList.add('hidden');
    document.getElementById('medicalReportsPage').classList.add('hidden');
    document.getElementById('prescriptionPage').classList.add('hidden');
  }
  function showRegister() {
    document.getElementById('dashboardPage').classList.add('hidden');
    document.getElementById('loginPage').classList.add('hidden');
    document.getElementById('appointmentPage').classList.add('hidden');
    document.getElementById('queuePage').classList.add('hidden');
    document.getElementById('medicalReportsPage').classList.add('hidden');
    document.getElementById('prescriptionPage').classList.add('hidden');
    document.getElementById('registerPage').classList.remove('hidden');
  }

  function register() {
    const name = document.getElementById('regName').value;
    const email = document.getElementById('regEmail').value;
    const password = document.getElementById('regPassword').value;
    const confirmPassword = document.getElementById('regConfirmPassword').value;
    const role = document.getElementById('regRole').value;

    if (!name || !email || !password || !confirmPassword || !role) {
      alert("Please fill all fields!");
      return;
    }
    if (password !== confirmPassword) {
      alert("Passwords do not match!");
      return;
    }

    localStorage.setItem("mediqueue_name", name);
    localStorage.setItem("mediqueue_email", email);
    localStorage.setItem("mediqueue_password", password);
    localStorage.setItem("mediqueue_role", role);

    alert("Registration Successful!");
    showLogin();
  }

  function login() {
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;

    const storedEmail = localStorage.getItem("mediqueue_email");
    const storedPassword = localStorage.getItem("mediqueue_password");

    if (email === storedEmail && password === storedPassword) {
      document.getElementById('loginPage').classList.add('hidden');
      document.getElementById('dashboardPage').classList.remove('hidden');
      document.getElementById('userName').textContent = localStorage.getItem("mediqueue_name");
      document.getElementById('profileName').textContent = localStorage.getItem("mediqueue_name");
      document.getElementById('profileEmail').textContent = localStorage.getItem("mediqueue_email");
      document.getElementById('profileRole').textContent = localStorage.getItem("mediqueue_role");
    } else {
      alert("Invalid credentials!");
    }
  }

  function showAppointment() {
    document.getElementById('dashboardPage').classList.add('hidden');
    document.getElementById('appointmentPage').classList.remove('hidden');
  }

  function backToDashboard() {
    document.getElementById('appointmentPage').classList.add('hidden');
    document.getElementById('dashboardPage').classList.remove('hidden');
  }

  function showQueue() {
    document.getElementById('registerPage').classList.add('hidden');
    document.getElementById('loginPage').classList.add('hidden');
    document.getElementById('appointmentPage').classList.add('hidden');
    document.getElementById('dashboardPage').classList.add('hidden');
    document.getElementById('queuePage').classList.remove('hidden');
    document.getElementById('medicalReportsPage').classList.add('hidden');
    document.getElementById('prescriptionPage').classList.add('hidden');
  }

  function backToDashboardFromQueue() {
    document.getElementById('queuePage').classList.add('hidden');
    document.getElementById('dashboardPage').classList.remove('hidden');
  }

  // Show Medical Reports page from dashboard
  const medicalReportsBtn = document.getElementById("medicalReportsBtn");
  const medicalReportsPage = document.getElementById("medicalReportsPage");
  medicalReportsBtn.addEventListener("click", () => {
    document.getElementById('dashboardPage').classList.add('hidden');
    medicalReportsPage.classList.remove('hidden');
    document.getElementById('prescriptionPage').classList.add('hidden');
  });

  document.getElementById("backFromReports").addEventListener("click", () => {
    medicalReportsPage.classList.add('hidden');
    document.getElementById('dashboardPage').classList.remove('hidden');
  });

  // Show Prescription page from dashboard
  const prescriptionBtn = document.getElementById("prescriptionBtn");
  const prescriptionPage = document.getElementById("prescriptionPage");
  prescriptionBtn.addEventListener("click", () => {
    document.getElementById("dashboardPage").classList.add("hidden");
    medicalReportsPage.classList.add('hidden');
    prescriptionPage.classList.remove("hidden");
  });

  // Back from Prescription page
  document.getElementById("backFromPrescription").addEventListener("click", () => {
    prescriptionPage.classList.add("hidden");
    document.getElementById("dashboardPage").classList.remove("hidden");
  });

  // --- QUEUE FUNCTIONS ---
  function updateQueueDisplay() {
    const queueList = document.getElementById("queueList");
    queueList.innerHTML = "";

    queue.forEach((patient) => {
      const li = document.createElement("li");
      li.innerText = `Token ${patient.token}: ${patient.name}`;
      queueList.appendChild(li);
    });
  }

  function updateCurrentTokenDisplay() {
    document.getElementById("currentToken").innerText = currentToken;
    const notification = document.getElementById("notification");
    const myToken = queue.find(p => p.name === "You")?.token;

    if (currentToken === myToken) {
      notification.style.display = "block";
      notification.innerText = "✅ It's your turn! Please proceed to the consultation room.";
    } else {
      notification.style.display = "none";
    }
  }

  function nextPatient() {
    if (queue.length > 0) {
      currentToken++;
      updateCurrentTokenDisplay();
    }
  }

  function completeCheckup() {
    queue = queue.filter(p => p.token !== currentToken);
    updateQueueDisplay();
  }

  // --- EDIT PROFILE MODAL ---
  function openEditModal() {
    document.getElementById('editName').value = localStorage.getItem("mediqueue_name");
    document.getElementById('editEmail').value = localStorage.getItem("mediqueue_email");
    document.getElementById('editRole').value = localStorage.getItem("mediqueue_role");
    document.getElementById('editModal').style.display = 'flex';
  }
  function closeEditModal() {
    document.getElementById('editModal').style.display = 'none';
  }
  function saveProfile() {
    const name = document.getElementById('editName').value;
    const email = document.getElementById('editEmail').value;
    const role = document.getElementById('editRole').value;

    localStorage.setItem("mediqueue_name", name);
    localStorage.setItem("mediqueue_email", email);
    localStorage.setItem("mediqueue_role", role);

    document.getElementById('userName').textContent = name;
    document.getElementById('profileName').textContent = name;
    document.getElementById('profileEmail').textContent = email;
    document.getElementById('profileRole').textContent = role;

    closeEditModal();
  }

  // --- DOCTOR CARDS ---
  function renderDoctors() {
    doctorsList.innerHTML = "";
    doctors.forEach((doc, i) => {
      const card = document.createElement("div");
      card.className = "doctor-card";
      card.innerHTML = `
        <img src="${doc.image}" alt="${doc.name}">
        <div class="doctor-name">${doc.name}</div>
        <div class="doctor-specialty">${doc.specialty}</div>
        <div class="doctor-details">Education: ${doc.education}</div>
        <div class="doctor-details">Experience: ${doc.experience}+ years</div>
        <div class="doctor-details">Languages: ${doc.languages.join(", ")}</div>
        <div class="doctor-bio">${doc.bio}</div>
        <button class="book-btn" onclick="openModal(${i})">Book Appointment</button>
      `;
      doctorsList.appendChild(card);
    });
  }

  function openModal(idx) {
    selectedDoctor = doctors[idx];
    document.getElementById("appointmentDate").value = "";
    document.getElementById("appointmentTime").value = "";
    modal.style.display = "flex";
  }

  function confirmBooking() {
    const date = document.getElementById("appointmentDate").value;
    const time = document.getElementById("appointmentTime").value;
    if (!date || !time) {
      alert("Please select both date and time.");
      return;
    }
    modal.style.display = "none";
    confirmationMsg.innerHTML = `✅ Appointment booked with <strong>${selectedDoctor.name}</strong> on <strong>${date}</strong> at <strong>${time}</strong>.`;
  }

  window.onclick = (e) => {
    if (e.target === modal) modal.style.display = "none";
  };

  // Attach event listeners to all 'Book Test' buttons inside medical reports
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('#medicalReportsPage .book-section button').forEach(function(btn) {
      btn.addEventListener('click', function(event) {
        event.preventDefault();
        alert('Booking Confirmed!');
      });
    });
  });

  // --- Prescription Modal Form Handling ---
  document.getElementById('prescriptionForm')?.addEventListener('submit', function(e) {
    e.preventDefault();

    const prescriptionText = document.getElementById('prescriptionText').value.trim();
    const prescriptionContent = document.getElementById('prescriptionContent');

    if (prescriptionText !== "") {
      prescriptionContent.textContent = prescriptionText;
    } else {
      prescriptionContent.textContent = "No prescription uploaded.";
    }

    const modal = bootstrap.Modal.getInstance(document.getElementById('uploadPrescriptionModal'));
    modal.hide();

    document.getElementById('prescriptionText').value = "";
  });

  // --- INITIAL LOAD ---
  renderDoctors();
  updateQueueDisplay();
  updateCurrentTokenDisplay();

</script>

<!-- Prescription Upload Modal -->
<div class="modal fade" id="uploadPrescriptionModal" tabindex="-1" aria-labelledby="uploadPrescriptionModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form id="prescriptionForm">
        <div class="modal-header">
          <h5 class="modal-title" id="uploadPrescriptionModalLabel">Upload Prescription</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        
        <div class="modal-body">
          <div class="mb-3">
            <label for="prescriptionText" class="form-label">Enter Prescription Details</label>
            <textarea class="form-control" id="prescriptionText" rows="5" placeholder="e.g., Tab Paracetamol 500mg - 1 tab twice daily for 5 days"></textarea>
          </div>
        </div>
        
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Save Prescription</button>
        </div>
      </form>
    </div>
  </div>
</div>

</body>
</html>
